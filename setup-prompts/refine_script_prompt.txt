Please refine this script and make it better